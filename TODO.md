# RaceScore Web - 修正・改善 TODO

## バグ修正（最優先）
- [x] 動的ルートのslug names統一（[id]を[raceKey]に統一）
  - [x] app/races/[ymd]/[course]/[raceNo] を削除
  - [x] ルート参照を修正
  - [x] API ルートの確認

## UI改善（スマホ対応）
- [x] 馬柱テーブルの横スクロール対応
  - [x] EntryTable.tsx の修正
  - [x] Tailwind CSS の overflow-x-auto 適用
  - [x] タッチスクロール対応
- [x] モバイルレイアウト最適化
  - [x] 列幅の調整
  - [x] フォントサイズの最適化
  - [x] ボタン・インタラクティブ要素のサイズ確認

## PWA対応
- [x] manifest.json の作成
- [x] Service Worker の設定 (sw.js)
- [x] layout.tsx に PWA メタタグを追加
- [ ] アイコン画像の作成

## Vercel対応
- [x] vercel.json の作成
- [x] .env.example の作成
- [x] README.md の更新

## GitHub & デプロイ
- [x] GitHub へのプッシュ
- [ ] Vercel との連携設定
- [ ] デプロイ確認

## 競うスコア実装（新規）

### 1. 競うスコア計算ロジックの修正
- [x] getClusterData.tsのcomputeKisoScore関数を修正
  - [x] 巻き返し指数を最重要項目として評価（前走50%、2走前10%、3走前5%）
  - [x] 加算式に変更（最大100点）
  - [x] 印の自動割り当てロジック追加（◎○▲☆△）

### 2. 馬柱タブ（EntryTable.tsx）の修正
- [ ] 印機能を小さく表示（馬番と馬名の間）
- [ ] 時計表示を修正（1538 → 1.53.8）
- [ ] 着差を表示（1.53.8 (0.5)）
- [ ] 通過順位を表示（4-4-4-3形式）
- [ ] 通過順位の色付け（ペース判定に基づく）
- [ ] 「1走前」表示を削除（タブに表示済み）
- [ ] 「ダダ1800m」表示バグを修正
- [ ] 巻き返し指数を表示（色付け: 0=灰色、1-4=青、5-8=オレンジ、9-10=赤）
- [ ] 競うスコアと印を表示（「くるでしょ」などのラベル削除）

### 3. 競う指数タブの新規作成
- [ ] 新規ページ作成（/race/[raceKey]/score）
- [ ] 簡易馬柱形式で表示
  - [ ] 馬番（枠色付き）
  - [ ] 印（◎○▲☆△）
  - [ ] 得点（競うスコア、色分け）
  - [ ] 馬名
  - [ ] 騎手
  - [ ] 得点順（1～10位）

### 4. PDF出力機能の実装
- [ ] PDF生成ライブラリのインストール（jsPDF or react-pdf）
- [ ] 競う指数タブにPDFダウンロードボタンを追加
- [ ] PDF出力機能の実装
