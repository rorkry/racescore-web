# 過去走が1件しか表示されない問題 - 根本原因の特定

## 🔴 重大な発見

### umadataテーブルのデータが極端に不足している

## 📊 調査結果

### 1. 総データ量
```
総件数: 3,407件
総馬数: 2,676頭
```

### 2. 過去走件数の分布
```
1件のみ: 2,054頭 (76.8%)
2件:      524頭 (19.6%)
3件:       88頭 (3.3%)
4件:        9頭 (0.3%)
5件以上:    1頭 (0.0%)  ← ほぼゼロ！
```

### 3. 実際のレースの馬の状況

**中山11R（16頭）:**
- 2件の過去走: 7頭
- 1件の過去走: 9頭
- **5件以上: 0頭**

**中山3R（16頭）:**
- **全頭0件（過去走データなし）**

**阪神11R（16頭）:**
- 2件の過去走: 3頭
- 1件の過去走: 8頭
- 0件の過去走: 5頭
- **5件以上: 0頭**

## 🎯 問題の根本原因

### **umadata.csvのインポートが極端に不完全**

**正常な状態:**
```
平均的な競走馬は10-20走程度の過去走がある
新馬でも0走、2-3歳馬で数走はある
```

**現在の状態:**
```
99.96%の馬が5件未満の過去走しかない
76.8%の馬が1件のみ
→ データがほとんど入っていない
```

## 📝 アーレムアレスの例

**現状:**
- umadataに1件のみ: 2025. 7.20 函館芝1800m

**本来あるべきデータ:**
- 2025.07.20 函館芝1800m ✅（これは存在）
- 2025.09.06 札幌芝1800m ❌（存在しない）
- 2025.11.16 京都芝2000m ❌（存在しない）
- その他の過去走も... ❌（存在しない）

## 🔧 解決方法

### 1. umadata.csvの確認
```
ファイルサイズと行数を確認:
- 2,676頭で3,407件は明らかに少なすぎる
- 平均1.3件/頭 → 正常なら10-20件/頭はあるはず
```

### 2. 完全なデータの再インポート
```
正しいumadata.csvを使って再インポート:
- 目安: 数万〜数十万件のデータになるはず
- 平均10件/頭として、約30,000件程度が妥当
```

### 3. インポートスクリプトの確認
```
現在のインポート処理で:
- データの取りこぼしがないか
- LIMIT句が設定されていないか
- エラーでスキップされていないか
```

## 結論

**APIやフロントエンドの問題ではなく、データベースに過去走データがほとんど入っていないことが根本原因**

**次のステップ:**
1. umadata.csvの内容を確認（ファイルサイズ、行数）
2. 完全なデータでインポートを実行
3. インポート後、データ量を再確認

**期待される結果:**
- 総件数: 30,000件以上（現在の約10倍）
- 過去走5件以上の馬: 50%以上
- 各馬の過去走: 平均10-20件程度












