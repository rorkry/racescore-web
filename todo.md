# RaceScore Web - TODO

## 完了済み
- [x] CSVアップロード機能
- [x] 競うスコア計算（巻き返し指数ベース）
- [x] 印の自動割当（◎○▲☆△）
- [x] 出馬表の表示改善
- [x] PDF出力機能の基本構造（開催地ごと）
- [x] PDF出力の日本語フォント対応（html2canvas使用）
- [x] PDF出力とWebページの見やすさ改善
- [x] 競う指数タブのデザイン改善（参考画像に基づく）
- [x] 動作確認とGitHubへのプッシュ
- [x] プロキシ設定の削除（next.config.ts）
- [x] 不要なAPIルート（trio）の外部サーバーフォールバック削除
- [x] Metadataの警告修正（generateViewport使用）
- [x] lib/db.tsのreadonly: trueオプションを削除
- [x] データベース初期化処理を追加（CREATE TABLE）
- [x] 不要なオッズデータ関連のコードを削除

## 新規タスク（2024-12-19 馬柱情報充実）
- [x] 馬番セルの枠番背景色実装（既に実装済み）
- [x] 印のUI改善
  - 馬番と馬名の間に移動
  - 横並びボタン → 選択タブ（ドロップダウン）に変更
- [x] 過去5走の表示形式改善
  - 時計表記を1538→1.53.8に変更（既に実装済み）
  - 馬場状態、コース、距離を追加
  - クラス、人気、着順を追加（既に実装済み）
  - 勝ち馬との時間差を追加（既に実装済み）
- [x] 動作確認（npm run dev）
- [x] GitHubへのプッシュ

## 新規タスク（2024-12-19 PDF出力改善）
- [x] レース表記を「阪神1R (クラス) ダ1800m」形式に変更
- [x] 表の囲い線を濃くする
- [x] 馬番の0を削除（01→1、02→2）
- [x] 「予測勝率」→「競うスコア」に訂正
- [x] PDF表をポスター会社レベルに改善
  - ヘッダー：濃い青色＋白文字＋太字
  - 馬番セル：枠番色の背景＋白文字＋太字
  - スコアセル：色グラデーション＋太字
  - 1-3位：背景色を濃く
  - 行間を広げる
  - フォントサイズを大きく
- [x] 動作確認（PDF出力）
- [x] GitHubへのプッシュ

## 新規タスク（2024-12-19 PDF表の枠番表示改善）
- [x] 枠番セルを馬番セルの左側に追加（色のみ、数字なし）
- [x] 馬番セルは白背景＋黒文字に変更
- [x] 芝ダートをレース表記に追加（wakujun.csvのO列から取得）
- [x] 馬名のフォントサイズを大きく
- [x] 動作確認（PDF出力）
- [x] GitHubへのプッシュ

## 新規タスク（2024-12-19 PDF表の騎手名・斤量追加）
- [x] 馬名の前の記号（$、*など）を削除
- [x] 「競うスコア」の列名を小さく（1行に収まるように）
- [x] 馬名と競うスコアの間に「騎手名」と「斤量」の列を追加
- [x] 動作確認（PDF出力）
- [x] GitHubへのプッシュ

## 新規タスク（2024-12-19 PDF軽量化）
- [x] 現在のPDF生成コードを確認（jsPDF設定）
- [x] 画像圧縮設定を追加
- [x] フォント埋め込みを最適化
- [x] PDF圧縮オプションを有効化
- [x] 動作確認（90MB → 数MB以下に削減）
- [x] GitHubへのプッシュ
